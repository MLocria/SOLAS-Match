<polymer-element name="claimed-tasks-stream" lightdom>
  <template>
    <h3>{{localisation.getTranslation("index_filter_available_tasks")}}</h3>
        <table>
          <thead>
            <tr>
              <th>{{localisation.getTranslation("common_task_type")}}</th>
              <th>Task Status<span style="color: red">*</span></th>
              <th>{{localisation.getTranslation("common_target_language")}}<span style="color: red">*</span></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <select name="taskTypes" selectedIndex="{{selectedTaskTypeFilter}}"> 
                  <option template repeat="{{key in taskTypeIndexes}}" value="{{key.toString()}}">
                    {{taskTypes[key]}}
                  </option>
                </select>
              </td>
              <td>
                <select name="taskStatusFilter" selectedIndex="{{selectedStatusFilter}}">
                    <option template repeat="{{key in statusFilterIndexes}}" value="{{key.toString()}}">
                      {{statusFilters[key]}}
                    </option>
                </select>
              </td>
              <td>
                <select name="targetLanguage" selectedIndex="{{selectedTargetFilter}}">
                  <option template repeat="{{language in activeTargetLanguages}}" value="{{language.code}}">
                    {{language.name}}
                  </option>
                </select>
              </td>
            </tr>
            <tr>
              <td>
                <button value="Filter" class="btn btn-primary" on-click="{{filterStream}}">
                  <i class="icon-refresh icon-white"></i> {{localisation.getTranslation("index_filter_task_stream")}}
                </button>
              </td>
            </tr>
          </tbody>  
        </table>
      <hr/>
     <!-- <br/><br/><br/><br/><br/><br/><br/> -->
    <template if="{{tasks.length > 0}}">
      <template repeat="{{task in tasks}}">
        <div class="task" style="word-break: break-all; overflow-wrap: break-word;">
          <h2>
            <a href="{{siteAddress}}task/{{task.id}}/id">
              {{task.title}}
            </a>
          </h2>
          <p>{{localisation.getTranslation("common_type")}}:
            <span class="label label-info" style="background-color: {{taskColours[task.taskType]}}">
              {{taskTypes[task.taskType]}}
            </span>
          </p>
          <p>
            {{localisation.getTranslation("common_from")}}: 
            <strong>{{task.sourceLocale.languageName}} - {{task.sourceLocale.countryName}} </strong>
          </p>
          <p>
            {{localisation.getTranslation("common_to")}}: 
            <strong>{{task.targetLocale.languageName}} - {{task.targetLocale.countryName}}</strong>
          </p>
          <p>
            {{localisation.getTranslation('common_status')}}:
            <strong>{{taskStatuses[task.taskStatus]}}</strong>
          </p>
          <p>
            <template repeat="{{tag in taskTags[task.id]}}">
              <a href="{{siteAddress}}tag/{{tag.id}}" class="label"><span class="label">{{tag.label}}</span></a>
            </template>
          </p>
          <p>
            {{localisation.getTranslation("common_word_count")}}: <strong>{{task.wordCount}}</strong>
          </p>
          <p id="task_age_{{task.id}}"></p>
          <p id="deadline_{{task.id}}"></p>
          <p id="parent_{{task.id}}"></p>
          <p>
            <a href="{{siteAddress}}user/task/{{task.id}}/reviews" class="btn btn-small btn-primary">
              {{localisation.getTranslation("claimed_tasks_task_reviews")}}
            </a>
          </p>
          <br />
        </div>
      </template>
    </template>
    <template if="{{tasks.length == 0}}">
      <p>{{localisation.getTranslation("index_no_tasks_available")}}</p>
    </template>
    <div class="pagination pagination-centered">
      <ul>
        <li>
          <a id="firstPage" title="First">&lt;&lt;</a>
        </li>
        <li>
          <a id="previousPage" title="Previous">&lt;</a>
        </li>
        <li>
          <a id="pagination_pages"></a>
        </li>
        <li>
          <a id="nextPage" title="Next">&gt;</a>
        </li>
        <li>
          <a id="lastPage" title="Last">&gt;&gt;</a>
        </li>
      </ul>
    </div>
  </template>
  <script type="application/dart" src="ClaimedTasksStream.dart"></script>
</polymer-element>